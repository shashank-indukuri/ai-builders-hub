{"paper_id": "temp_dir\\wine5", "title": "Modeling wine preferences by data mining from physicochemical properties", "abstract": "We propose a data mining approach to predict human wine taste preferences that is based on easily available analytical tests at the certification step. A large dataset (when compared to other studies in this domain) is considered, with white and red vinho verde samples (from Portugal). Three regression techniques were applied, under a computationally efficient procedure that performs simultaneous variable and model selection. The support vector machine achieved promising results, outperforming the multiple regression and neural network methods. Such model is useful to support the oenologist wine tasting evaluations and improve wine production. Furthermore, similar techniques can help in target marketing by modeling consumer tastes from niche markets.", "pdf_parse": {"paper_id": "temp_dir\\wine5", "abstract": [{"text": "We propose a data mining approach to predict human wine taste preferences that is based on easily available analytical tests at the certification step. A large dataset (when compared to other studies in this domain) is considered, with white and red vinho verde samples (from Portugal). Three regression techniques were applied, under a computationally efficient procedure that performs simultaneous variable and model selection. The support vector machine achieved promising results, outperforming the multiple regression and neural network methods. Such model is useful to support the oenologist wine tasting evaluations and improve wine production. Furthermore, similar techniques can help in target marketing by modeling consumer tastes from niche markets.", "section": "Abstract", "sec_num": null}], "body_text": [{"text": "Once viewed as a luxury good, nowadays wine is increasingly enjoyed by a wider range of consumers. Portugal is a top ten wine exporting country with 3.17% of the market share in 2005 [11] . Exports of its vinho verde wine (from the northwest region) have increased by 36% from 1997 to 2007 [8] . To support its growth, the wine industry is investing in new technologies for both wine making and selling processes. Wine certification and quality assessment are key elements within this context. Certification prevents the illegal adulteration of wines (to safeguard human health) and assures quality for the wine market.", "section": "Introduction", "sec_num": "1"}, {"text": "Quality evaluation is often part of the certification process and can be used to improve wine making (by identifying the most influential factors) and to stratify wines such as premium brands (useful for setting prices).", "section": "Introduction", "sec_num": "1"}, {"text": "Wine certification is generally assessed by physicochemical and sensory tests [10] . Physicochemical laboratory tests routinely used to characterize wine include determination of density, alcohol or pH values, while sensory tests rely mainly on human experts. It should be stressed that taste is the least understood of the human senses [25] , thus wine classification is a difficult task.", "section": "Introduction", "sec_num": "1"}, {"text": "Moreover, the relationships between the physicochemical and sensory analysis are complex and still not fully understood [20] .", "section": "Introduction", "sec_num": "1"}, {"text": "Advances in information technologies have made it possible to collect, store and process massive, often highly complex datasets. All this data hold valuable information such as trends and patterns, which can be used to improve decision making and optimize chances of success [28] . Data mining (DM) techniques [33] aim at extracting high-level knowledge from raw data. There are several DM algorithms, each one with its own advantages. When modeling continuous data, the linear/multiple regression (MR) is the classic approach. The backpropagation algorithm was first introduced in 1974 [32] and later popularized in 1986 [23] . Since then, neural networks (NNs) have become increasingly used. More recently, support vector machines (SVMs) have also been proposed [4] [26] . Due to their higher flexibility and nonlinear learning capabilities, both NNs and SVMs are gaining an attention within the DM field, often attaining high predictive performances [16] [17] . SVMs present theoretical advantages over NNs, such as the absence of local minima in the learning phase. In effect, the SVM was recently considered one of the most influential DM algorithms [34] . While the MR model is easier to interpret, it is still possible to extract knowledge from NNs and SVMs, given in terms of input variable importance [18] [7] .", "section": "Introduction", "sec_num": "1"}, {"text": "When applying these DM methods, variable and model selection are critical issues. Variable selection [14] is useful to discard irrelevant inputs, leading to simpler models that are easier to interpret and that usually give better performances. Complex models may overfit the data, losing the capability to generalize, while a model that is too simple will present limited learning capabilities. Indeed, both NN and SVM have hyperparameters that need to be adjusted [16] , such as the number of NN hidden nodes or the SVM kernel parameter, in order to get good predictive accuracy (see Section 2.3).", "section": "Introduction", "sec_num": "1"}, {"text": "The use of decision support systems by the wine industry is mainly focused on the wine production phase [12] . Despite the potential of DM techniques to predict wine quality based on physicochemical data, their use is rather scarce and mostly considers small datasets. For example, in 1991 the \"Wine\" dataset was donated into the UCI repository [1] . The data contain 178 examples with measurements of 13 chemical constituents (e.g. alcohol, Mg) and the goal is to classify three cultivars from Italy. This dataset is very easy to discriminate and has been mainly used as a benchmark for new DM classifiers. In 1997 [27] , a NN fed with 15 input variables (e.g. Zn and Mg levels) was used to predict six geographic wine origins. The data included 170 samples from Germany and a 100% predictive rate was reported. In 2001 [30] , NNs were used to classify three sensory attributes (e.g. sweetness) of Californian wine, based on grape maturity levels and chemical analysis (e.g. titrable acidity). Only 36 examples were used and a 6% error was achieved. Several physicochemical parameters (e.g. alcohol, density) were used in [20] to characterize 56 samples of Italian wine. Yet, the authors argued that mapping these parameters with a sensory taste panel is a very difficult task and instead they used a NN fed with data taken from an electronic tongue. More recently, mineral characterization (e.g. Zn and Mg) was used to discriminate 54 samples into two red wine classes [21] . A probabilistic NN was adopted, attaining 95% accuracy. As a powerful learning tool, SVM has outperformed NN in several applications, such as predicting meat preferences [7] . Yet, in the field of wine quality only one application has been reported, where spectral measurements from 147 bottles were successfully used to predict 3 categories of rice wine age [35] .", "section": "Introduction", "sec_num": "1"}, {"text": "In this paper, we present a case study for modeling taste preferences based on analytical data that are easily available at the wine certification step. Building such model is valuable not only for certification entities but also wine producers and even consumers. It can be used to support the oenologist wine evaluations, potentially improving the quality and speed of their decisions. Moreover, measuring the impact of the physicochemical tests in the final wine quality is useful for improving the production process. Furthermore, it can help in target marketing [24] , i.e. by applying similar techniques to model the consumers preferences of niche and/or profitable markets.", "section": "Introduction", "sec_num": "1"}, {"text": "The main contributions of this work are:", "section": "Introduction", "sec_num": "1"}, {"text": "\u2022 We present a novel method that performs simultaneous variable and model selection for NN and SVM techniques. The variable selection is based on sensitivity analysis [18] , which is a computationally efficient method that measures input relevance and guides the variable selection process. Also, we propose a parsimony search method to select the best SVM kernel parameter with a low computational effort.", "section": "Introduction", "sec_num": "1"}, {"text": "\u2022 We test such approach in a real-world application, the prediction of vinho verde wine (from the Minho region of Portugal) taste preferences, showing its impact in this domain. In contrast with previous studies, a large dataset is considered, with a total of 4898 white and 1599 red samples. Wine preferences are modeled under a regression approach, which preserves the order of the grades, and we show how the definition of the tolerance concept is useful for accessing different performance levels. We believe that this integrated approach is valuable to support applications where ranked sensory preferences are required, for example in wine or meat quality assurance.", "section": "Introduction", "sec_num": "1"}, {"text": "The paper is organized as follows: Section 2 presents the wine data, DM models and variable selection approach; in Section 3, the experimental design is described and the obtained results are analyzed; finally, conclusions are drawn in Section 4.", "section": "Introduction", "sec_num": "1"}, {"text": "This study will consider vinho verde, a unique product from the Minho (northwest) region of Portugal. Medium in alcohol, is it particularly appreciated due to its freshness (specially in the summer). This wine accounts for 15% of the total Portuguese production [8] , and around 10% is exported, mostly white wine. In this work, we will analyze the two most common variants, white and red (ros\u00e9 is also produced), from the demarcated region of vinho verde. The data were collected from May/2004 to February/2007 using only protected designation of origin samples that were tested at the official certification entity (CVRVV). The CVRVV is an inter-professional organization with the goal of improving the quality and marketing of vinho verde. The data were recorded by a computerized system (iLab), which automatically manages the process of wine sample testing from producer requests to laboratory and sensory analysis. Each entry denotes a given test (analytical or sensory) and the final database was exported into a single sheet (.csv).", "section": "Wine data", "sec_num": "2.1"}, {"text": "During the preprocessing stage, the database was transformed in order to include a distinct wine sample (with all tests) per row. To avoid discarding examples, only the most common physicochemical tests were selected. Since the red and white tastes are quite different, the analysis will be performed separately, thus two datasets1 were built with 1599 red and 4898 white examples. Table 1 presents the physicochemical statistics per dataset. Regarding the preferences, each sample was evaluated by a minimum of three sensory assessors (using blind tastes), which graded the wine in a scale that ranges from 0 (very bad) to 10 (excellent). The final sensory score is given by the median of these evaluations. Fig. 1 plots the histograms of the target variables, denoting a typical normal shape distribution (i.e. with more normal grades that extreme ones).", "section": "Wine data", "sec_num": "2.1"}, {"text": "[ insert Table 1 and Fig. 1 around here ]", "section": "Wine data", "sec_num": "2.1"}, {"text": "We will adopt a regression approach, which preserves the order of the preferences. For instance, if the true grade is 3, then a model that predicts 4 is better than one that predicts 7. A regression dataset D is made up of k \u2208 {1, ..., N } examples, each mapping an input vector with I input variables (x k 1 , . . . , x k I ) to a given target y k . The regression performance is commonly measured by an error metric, such as the mean absolute deviation (MAD) [33] :", "section": "Data mining approach and evaluation", "sec_num": "2.2"}, {"text": "EQUATION", "section": "Data mining approach and evaluation", "sec_num": "2.2"}, {"text": "where y k is the predicted value for the k input pattern. The regression error characteristic (REC) curve [2] is also used to compare regression models, with the ideal model presenting an area of 1.0. The curve plots the absolute error tolerance T (x-axis), versus the percentage of points correctly predicted (the accuracy) within the tolerance (y-axis).", "section": "Data mining approach and evaluation", "sec_num": "2.2"}, {"text": "The confusion matrix is often used for classification analysis, where a C \u00d7 C matrix (C is the number of classes) is created by matching the predicted values (in columns) with the desired classes (in rows). For an ordered output, the predicted class is given by p i = y i , if |y i -y i | \u2264 T , else p i = y i , where y i denotes the closest class to y i , given that y i = y i . From the matrix, several metrics can be used to access the overall classification performance, such as the accuracy and precision (i.e. the predicted column accuracies) [33] .", "section": "Data mining approach and evaluation", "sec_num": "2.2"}, {"text": "The holdout validation is commonly used to estimate the generalization capability of a model [19] . This method randomly partitions the data into training and test subsets. The former subset is used to fit the model (typically with 2/3 of the data), while the latter (with the remaining 1/3) is used to compute the estimate. A more robust estimation procedure is the k-fold cross-validation [9] , where the data is divided into k partitions of equal size. One subset is tested each time and the remaining data are used for fitting the model. The process is repeated sequentially until all subsets have been tested. Therefore, under this scheme, all data are used for training and testing. However, this method requires around k times more computation, since k models are fitted.", "section": "Data mining approach and evaluation", "sec_num": "2.2"}, {"text": "We will adopt the most common NN type, the multilayer perceptron, where neurons are grouped into layers and connected by feedforward links [3] . For regression tasks, this NN architecture is often based on one hidden layer of H hidden nodes with a logistic activation and one output node with a linear function [16] :", "section": "Data mining methods", "sec_num": "2.3"}, {"text": "EQUATION", "section": "Data mining methods", "sec_num": "2.3"}, {"text": "where w i,j denotes the weight of the connection from node j to i and o the output node. The performance is sensitive to the topology choice (H). A NN with H = 0 is equivalent to the MR model. By increasing H, more complex mappings can be performed, yet an excess value of H will overfit the data, leading to generalization loss. A computationally efficient method to set H is to search through the range {0, 1, 2, 3, . . . , H max } (i.e. from the simplest NN to more complex ones). For each H value, a NN is trained and its generalization estimate is measured (e.g. over a validation sample). The process is stopped when the generalization decreases or when H reaches the maximum value (H max ).", "section": "Data mining methods", "sec_num": "2.3"}, {"text": "In SVM regression [26] , the input x \u2208 I is transformed into a high mdimensional feature space, by using a nonlinear mapping (\u03c6) that does not need to be explicitly known but that depends of a kernel function (K). The aim of a SVM is to find the best linear separating hyperplane, tolerating a small error ( ) when fitting the data, in the feature space:", "section": "Data mining methods", "sec_num": "2.3"}, {"text": "EQUATION", "section": "Data mining methods", "sec_num": "2.3"}, {"text": "The -insensitive loss function sets an insensitive tube around the residuals and the tiny errors within the tube are discarded (Fig. 2 ).", "section": "Data mining methods", "sec_num": "2.3"}, {"text": "[ insert Fig. 2 around here ]", "section": "Data mining methods", "sec_num": "2.3"}, {"text": "We will adopt the popular gaussian kernel, which presents less parameters than other kernels (e.g. polynomial) [31] :", "section": "Data mining methods", "sec_num": "2.3"}, {"text": "K(x, x ) = exp(-\u03b3||x-x || 2 ), \u03b3 > 0.", "section": "Data mining methods", "sec_num": "2.3"}, {"text": "Under this setup, the SVM performance is affected by three parameters: \u03b3, and C (a trade-off between fitting the errors and the flatness of the mapping). To reduce the search space, the first two values will be set using the heuristics [5] :", "section": "Data mining methods", "sec_num": "2.3"}, {"text": "C = 3", "section": "Data mining methods", "sec_num": "2.3"}, {"text": "(for a standardized output) and = \u03c3/ \u221a N , where", "section": "Data mining methods", "sec_num": "2.3"}, {"text": "\u03c3 = 1.5/N \u00d7 N i=1 (y i -y i ) 2", "section": "Data mining methods", "sec_num": "2.3"}, {"text": "and y is the value predicted by a 3-nearest neighbor algorithm. The kernel parameter (\u03b3) produces the highest impact in the SVM performance, with values that are too large or too small leading to poor predictions. A practical method to set \u03b3 is to start the search from one of the extremes and then search towards the middle of the range while the predictive estimate increases [31] .", "section": "Data mining methods", "sec_num": "2.3"}, {"text": "Sensitivity analysis [18] is a simple procedure that is applied after the training phase and analyzes the model responses when the inputs are changed.", "section": "Variable and Model Selection", "sec_num": "2.4"}, {"text": "Originally proposed for NNs, this sensitivity method can also be applied to other algorithms, such as SVM [7] . Let y a j denote the output obtained by holding all input variables at their average values except x a , which varies through its entire range with j \u2208 {1, . . . , L} levels. If a given input variable (x a \u2208 {x 1 , . . . , x I }) is relevant then it should produce a high variance (V a ).", "section": "Variable and Model Selection", "sec_num": "2.4"}, {"text": "Thus, its relative importance (R a ) can be given by:", "section": "Variable and Model Selection", "sec_num": "2.4"}, {"text": "EQUATION", "section": "Variable and Model Selection", "sec_num": "2.4"}, {"text": "In this work, the R a values will be used to measure the importance of the inputs and also to discard irrelevant inputs, guiding the variable selection algorithm.", "section": "Variable and Model Selection", "sec_num": "2.4"}, {"text": "We will adopt the popular backward selection, which starts with all variables and iteratively deletes one input until a stopping criterion is met [14] . Yet, we guide the variable deletion (at each step) by the sensitivity analysis, in a variant that allows a reduction of the computational effort by a factor of I (when compared to the standard backward procedure) and that in [18] has outperformed other methods (e.g. backward and genetic algorithms). Similarly to [36] , the variable and model selection will be performed simultaneously, i.e.", "section": "Variable and Model Selection", "sec_num": "2.4"}, {"text": "in each backward iteration several models are searched, with the one that presents the best generalization estimate selected. For a given DM method, the overall procedure is depicted bellow:", "section": "Variable and Model Selection", "sec_num": "2.4"}, {"text": "(1) Start with all F = {x 1 , . . . , x I } input variables.", "section": "Variable and Model Selection", "sec_num": "2.4"}, {"text": "( (3) After fitting the model, compute the relative importances (R i ) of all x i \u2208 F variables and delete from F the least relevant input. Go to step 4 if the stopping criterion is met, otherwise return to step 2.", "section": "Variable and Model Selection", "sec_num": "2.4"}, {"text": "EQUATION", "section": "Variable and Model Selection", "sec_num": "2.4"}, {"text": "(4) Select the best F (and P in case of NN or SVM) values, i.e., the input variables and model that provide the best predictive estimates. Finally, retrain this configuration with all available data.", "section": "Variable and Model Selection", "sec_num": "2.4"}, {"text": "The R environment [22] is an open source, multiple platform (e.g. Windows, Linux) and high-level matrix programming language for statistical and data analysis. All experiments reported in this work were written in R and conducted in a Linux server, with an Intel dual core processor. In particular, we adopted the RMiner [6], a library for the R tool that facilitates the use of DM techniques in classification and regression tasks.", "section": "Empirical results", "sec_num": "3"}, {"text": "Before fitting the models, the data was first standardized to a zero mean and one standard deviation [16] . RMiner uses the efficient BFGS algorithm to train the NNs (nnet R package), while the SVM fit is based on the Sequential Minimal Optimization implementation provided by LIBSVM (kernlab package). We adopted the default R suggestions [29] . The only exception are the hyperparameters (H and \u03b3), which will be set using the procedure described in the previous section and with the search ranges of H \u2208 {0, 1, . . . , 11} [36] and \u03b3 \u2208 {2 3 , 2 1 , . . . , 2 -15 } [31] . While the maximum number of searches is 12/10, in practice the parsimony approach (step 2 of Section 2.4) will reduce this number substantially.", "section": "Empirical results", "sec_num": "3"}, {"text": "Regarding the variable selection, we set the estimation metric to the M AD value (Equation 1), as advised in [31] . To reduce the computational effort, we adopted the simpler 2/3 and 1/3 holdout split as the internal validation method. The sensitivity analysis parameter was set to L = 5, i.e. x a \u2208 {-1.0, -0.5, . . . , 1.0} for a standardized input. As a reasonable balance between the pressure towards simpler models and the increase of computational search, the stopping criterion was set to 2 iterations without any improvement or when only one input is available.", "section": "Empirical results", "sec_num": "3"}, {"text": "To evaluate the selected models, we adopted 20 runs of the more robust 5-fold cross-validation, in a total of 20\u00d75=100 experiments for each tested configuration. Statistical confidence will be given by the t-student test at the 95% confidence level [13] . The results are summarized in Table 2 . The test set errors are shown in terms of the mean and confidence intervals. Three metrics are present: M AD, the classification accuracy for different tolerances (i.e. T = 0.25, 0.5 and 1.0) and Kappa (T = 0.5). The selected models are described in terms of the average number of inputs (I) and hyperparameter value (H or \u03b3). The last row shows the total computational time required in seconds.", "section": "Empirical results", "sec_num": "3"}, {"text": "[ insert Table 2 and Fig. 3 around here ]", "section": "Empirical results", "sec_num": "3"}, {"text": "For both tasks and all error metrics, the SVM is the best choice. The differences are higher for small tolerances and in particular for the white wine (e.g. for T = 0.25, the SVM accuracy is almost two times better when compared to other methods). This effect is clearly visible when plotting the full REC curves (Fig. 3 ). The Kappa statistic [33] measures the accuracy when compared with a random classifier (which presents a Kappa value of 0%). The higher the statistic, the more accurate the result. The most practical tolerance values are T = 0.5 and T = 1.0. The former tolerance rounds the regression response into the nearest class, while the latter accepts a response that is correct within one of the two closest classes (e.g. a 3.1 value can be interpreted as grade 3 or 4 but not 2 or 5). For T = 0.5, the SVM accuracy improvement is 3.3 pp for red wine (6.2 pp for Kappa), a value that increases to 12.0 pp for the white task (20.4 pp for Kappa). The NN is quite similar to MR in the red wine modeling, thus similar performances were achieved. For the white data, a more complex NN model (H = 2.1) was selected, slightly outperforming the MR results. Regarding the variable selection, the average number of deleted inputs ranges from 0.9 to 1.8, showing that most of the physicochemical tests used are relevant. In terms of computational effort, the SVM is the most expensive method, particularly for the larger white dataset.", "section": "Empirical results", "sec_num": "3"}, {"text": "A detailed analysis of the SVM classification results is presented by the average confusion matrixes for T = 0.5 (Table 3 ). To simplify the visualization, the 3 and 9 grade predictions were omitted, since these were always empty. Most of the values are close to the diagonals (in bold), denoting a good fit by the model.", "section": "Empirical results", "sec_num": "3"}, {"text": "The true predictive accuracy for each class is given by the precision metric (e.g. for the grade 4 and white wine, precision T =0.5 =19/(19+7+4)=63.3%).", "section": "Empirical results", "sec_num": "3"}, {"text": "This statistic is important in practice, since in a real deployment setting the actual values are unknown and all predictions within a given column would be treated the same. For a tolerance of 0.5, the SVM red wine accuracies are around 57.7 to 67.5% in the intermediate grades (5 to 7) and very low (0%/20%) for the extreme classes (3, 8 and 4), which are less frequent (Fig. 1 ). In general, the white data results are better: 60.3/63.3% for classes 6 and 4, 67.8/72.6% for grades 7 and 5, and a surprising 85.5% for the class 8 (the exception are the 3 and 9 extremes with 0%, not shown in the table). When the tolerance is increased (T = 1.0), high accuracies ranging from 81.9 to 100% are attained for both wine types and classes 4 to 8.", "section": "Empirical results", "sec_num": "3"}, {"text": "[ insert Table 3 and Fig. 4 around here ]", "section": "Empirical results", "sec_num": "3"}, {"text": "The average SVM relative importance plots (R a values) of the analytical tests are shown in Fig. 4 . It should be noted that the whole 11 inputs are shown, since in each simulation different sets of variables can be selected. In several cases, the obtained results confirm the oenological theory. For instance, an increase in the alcohol (4th and 2nd most relevant factor) tends to result in a higher quality wine. Also, the rankings are different within each wine type.", "section": "Empirical results", "sec_num": "3"}, {"text": "For instance, the citric acid and residual sugar levels are more important in white wine, where the equilibrium between the freshness and sweet taste is more appreciated. Moreover, the volatile acidity has a negative impact, since acetic acid is the key ingredient in vinegar. The most intriguing result is the high importance of sulphates, ranked first for both cases. Oenologically this result could be very interesting. An increase in sulphates might be related to the fermenting nutrition, which is very important to improve the wine aroma.", "section": "Empirical results", "sec_num": "3"}, {"text": "In recent years, the interest in wine has increased, leading to growth of the wine industry. As a consequence, companies are investing in new technologies to improve wine production and selling. Quality certification is a crucial step for both processes and is currently largely dependent on wine tasting by human experts. This work aims at the prediction of wine preferences from objective analytical tests that are available at the certification step. A large dataset (with 4898 white and 1599 red entries) was considered, including vinho verde samples from the northwest region of Portugal. This case study was addressed by two regression tasks, where each wine type preference is modeled in a continuous scale, from 0 (very bad) to 10 (excellent). This approach preserves the order of the classes, allowing the evaluation of distinct accuracies, according to the degree of error tolerance (T ) that is accepted.", "section": "Empirical results", "sec_num": "3"}, {"text": "Due to advances in the data mining (DM) field, it is possible to extract knowledge from raw data. Indeed, powerful techniques such as neural networks (NNs) and more recently support vector machines (SVMs) are emerging. While being more flexible models (i.e. no a priori restriction is imposed), the performance depends on a correct setting of hyperparameters (e.g. number of hidden nodes of the NN architecture or SVM kernel parameter). On the other hand, the multiple regression (MR) is easier to interpret than NN/SVM, with most of the NN/SVM applications considering their models as black boxes.", "section": "Empirical results", "sec_num": "3"}, {"text": "Another relevant aspect is variable selection, which leads to simpler models while often improving the predictive performance. In this study, we present an integrated and computationally efficient approach to deal with these issues.", "section": "Empirical results", "sec_num": "3"}, {"text": "Sensitivity analysis is used to extract knowledge from the NN/SVM models, given in terms of relative importance of the inputs. Simultaneous variable and model selection scheme is also proposed, where the variable selection is guided by sensitivity analysis and the model selection is based on parsimony search that starts from a reasonable value and is stopped when the generalization estimate decreases.", "section": "Empirical results", "sec_num": "3"}, {"text": "Encouraging results were achieved, with the SVM model providing the best performances, outperforming the NN and MR techniques, particularly for white vinho verde wine, which is the most common type. When admitting only the correct classified classes (T = 0.5), the overall accuracies are 62.4%", "section": "Empirical results", "sec_num": "3"}, {"text": "(red) and 64.6% (white). It should be noted that the datasets contain six/seven classes (from 3 to 8/9). These accuracies are much better than the ones expected by a random classifier. The performance is substantially improved when the tolerance is set to accept responses that are correct within the one of the two nearest classes (T = 1.0), obtaining a global accuracy of 89.0% (red) and 86.8% (white). In particular, for both tasks the majority of the classes present an individual accuracy (precision) higher than 90%.", "section": "Empirical results", "sec_num": "3"}, {"text": "The superiority of SVM over NN is probably due to the differences in the training phase. The SVM algorithm guarantees an optimum fit, while NN training may fall into a local minimum. Also, the SVM cost function (Fig. 2 ) gives a linear penalty to large errors. In contrast, the NN algorithm minimizes the sum of squared errors. Thus, the SVM is expected to be less sensitive to outliers and this effect results in a higher accuracy for low error tolerances. As argued in [15] , it is difficult to compare DM methods in a fair way, with data analysts tending to favor models that they know better. We adopted the default suggestions of the R tool [29] , except for the hyperparameters (which were set using a grid search). Since the default settings are more commonly used, this seems a reasonable assumption for the comparison. Nevertheless, different NN results could be achieved if different hidden node and/or minimization cost functions were used. Under the tested setup, the SVM algorithm provided the best results while requiring more computation. Yet, the SVM fitting can still be achieved within a reasonable time with current processors. For example, one run of the 5-fold cross-validation testing takes around 26 minutes for the larger white dataset, which covers a three-year collection period.", "section": "Empirical results", "sec_num": "3"}, {"text": "The result of this work is important for the wine industry. At the certification phase and by Portuguese law, the sensory analysis has to be performed by human tasters. Yet, the evaluations are based in the experience and knowledge of the experts, which are prone to subjective factors. The proposed data-driven approach is based on objective tests and thus it can be integrated into a decision support system, aiding the speed and quality of the oenologist performance. For instance, the expert could repeat the tasting only if her/his grade is far from the one predicted by the DM model. In effect, within this domain the T = 1.0 distance is accepted as a good quality control process and, as shown in this study, high accuracies were achieved for this tolerance. The model could also be used to improve the training of oenology students. Furthermore, the relative importance of the inputs brought interesting insights regarding the impact of the analytical tests. Since some variables can be controlled in the production process this information can be used to improve the wine quality. For instance, alcohol concentration can be increased or decreased by monitoring the grape sugar concentration prior to the harvest. Also, the residual sugar in wine could be raised by suspending the sugar fermentation carried out by yeasts. Moreover, the volatile acidity produced during the malolactic fermentation in red wine depends on the lactic bacteria control activity.", "section": "Empirical results", "sec_num": "3"}, {"text": "Another interesting application is target marketing [24] . Specific consumer preferences from niche and/or profitable markets (e.g. for a particular country) could be measured during promotion campaigns (e.g. free wine tastings at supermarkets) and modeled using similar DM techniques, aiming at the design of brands that match these market needs. ", "section": "Empirical results", "sec_num": "3"}, {"text": "The datasets are available at: http://www3.dsi.uminho.pt/pcortez/wine/", "section": "", "sec_num": null}], "back_matter": [{"text": "We would like to thank Cristina Lagido and the anonymous reviewers for their helpful comments. The work of P. Cortez is supported by the FCT project PTDC/EIA/64541/2006.", "section": "Acknowledgments", "sec_num": null}, {"text": "Sensory preference Frequency (wine samples) ", "section": "White wine", "sec_num": null}], "ref_entries": {"FIGREF0": {"text": "Fig. 2. Example of a linear SVM regression and the -insensitive loss function (adapted from [26])", "fig_num": "24", "type_str": "figure", "num": null, "uris": null}, "TABREF0": {"text": "If there is a hyperparameter P \u2208 {P 1 , . . . , P k } to tune (e.g. NN or SVM), start with P 1 and go through the remaining range until the generalization estimate decreases. Compute the generalization estimate of the model by", "type_str": "table", "html": null, "num": null, "content": "<table/>"}, "TABREF1": {"text": "The physicochemical data statistics per wine type", "type_str": "table", "html": null, "num": null, "content": "<table><tr><td>Attribute (units)</td><td/><td>Red wine</td><td/><td colspan=\"3\">White wine</td></tr><tr><td/><td colspan=\"6\">Min Max Mean Min Max Mean</td></tr><tr><td>fixed acidity (g(tartaric acid)/dm 3 )</td><td>4.6</td><td>15.9</td><td>8.3</td><td>3.8</td><td>14.2</td><td>6.9</td></tr><tr><td>volatile acidity (g(acetic acid)/dm 3 )</td><td>0.1</td><td>1.6</td><td>0.5</td><td>0.1</td><td>1.1</td><td>0.3</td></tr><tr><td>citric acid (g/dm 3 )</td><td>0.0</td><td>1.0</td><td>0.3</td><td>0.0</td><td>1.7</td><td>0.3</td></tr><tr><td>residual sugar (g/dm 3 )</td><td>0.9</td><td>15.5</td><td>2.5</td><td>0.6</td><td>65.8</td><td>6.4</td></tr><tr><td>chlorides (g(sodium chloride)/dm 3 )</td><td>0.01</td><td>0.61</td><td>0.08</td><td>0.01</td><td>0.35</td><td>0.05</td></tr><tr><td>free sulfur dioxide (mg/dm 3 )</td><td>1</td><td>72</td><td>14</td><td>2</td><td>289</td><td>35</td></tr><tr><td>total sulfur dioxide (mg/dm 3 )</td><td>6</td><td>289</td><td>46</td><td>9</td><td>440</td><td>138</td></tr><tr><td>density (g/cm 3 )</td><td colspan=\"2\">0.990 1.004</td><td colspan=\"3\">0.996 0.987 1.039</td><td>0.994</td></tr><tr><td>pH</td><td>2.7</td><td>4.0</td><td>3.3</td><td>2.7</td><td>3.8</td><td>3.1</td></tr><tr><td>sulphates (g(potassium sulphate)/dm 3 )</td><td>0.3</td><td>2.0</td><td>0.7</td><td>0.2</td><td>1.1</td><td>0.5</td></tr><tr><td>alcohol (% vol.)</td><td>8.4</td><td>14.9</td><td>10.4</td><td>8.0</td><td>14.2</td><td>10.4</td></tr></table>"}, "TABREF2": {"text": "The wine modeling results (test set errors and selected models; best values in bold)", "type_str": "table", "html": null, "num": null, "content": "<table><tr><td/><td/><td>Red wine</td><td/><td/><td>White wine</td></tr><tr><td/><td>MR</td><td>NN</td><td>SVM</td><td>MR</td><td>NN</td><td>SVM</td></tr><tr><td>MAD</td><td colspan=\"3\">0.50\u00b10.00 0.51\u00b10.00 0.46\u00b10.00</td><td colspan=\"3\">0.59\u00b10.00 0.58\u00b10.00 0.45\u00b10.00</td></tr></table>"}}}}